{"version":3,"sources":["webpack:///server.js","webpack:///webpack/bootstrap e325875d596869d0b30a","webpack:///./server/app.js","webpack:///external \"babel-runtime/core-js/object/assign\"","webpack:///external \"babel-runtime/core-js/get-iterator\"","webpack:///external \"os\"","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///external \"child_process\"","webpack:///external \"lodash\"","webpack:///external \"keypair\"","webpack:///./lib/cycle.js","webpack:///external \"babel-runtime/core-js/object/keys\"","webpack:///external \"babel-runtime/helpers/typeof\"","webpack:///./server/bunyan-stream.js","webpack:///./server/utils.js","webpack:///./lib/common-utils.js","webpack:///./server/setup-server.js","webpack:///external \"restify\"","webpack:///./server/setup-socket.js","webpack:///external \"socket.io\"","webpack:///./server/command-manager.js","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"minimist\"","webpack:///./server/ssh-manager.js","webpack:///external \"babel-runtime/core-js/json/stringify\"","webpack:///external \"ssh2\"","webpack:///external \"terminal-kit\"","webpack:///./server/user-manager.js","webpack:///external \"scrypt\"","webpack:///external \"events\"","webpack:///external \"source-map-support\""],"names":["require","install","module","exports","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","NodeMonkey","opts","warnConsole","warned","warningMsg","join","self","local","warn","remote","NODE_ENV","process","options","this","_lodash2","merge","server","host","port","DEFAULT_PORT","silent","bufferSize","attachOnStart","disableLocalOutput","client","showCallerInfo","convertStyles","ssh","enabled","title","_os2","hostname","prompt","dataDir","msgBuffer","BUNYAN_STREAM","_bunyanStream2","_attached","_typeHandlers","_createLocal","_createRemote","_setupCmdMan","_setupUserManager","_setupServer","_setupSSH","attachConsole","Object","defineProperty","value","console","mapValues","fn","method","localFn","apply","arguments","remoteFn","callerStackDistance","_assign","_assign2","_getIterator2","_getIterator3","_keys","_keys2","_os","_fs","_fs2","_path","_path2","_events","_events2","_lodash","_keypair","_keypair2","_cycle","_cycle2","_bunyanStream","_setupServer2","_setupServer3","_setupSocket","_setupSocket2","_sshManager","_sshManager2","_commandManager","_commandManager2","_userManager","_userManager2","_utils","_utils2","CONSOLE","ConsoleEvent","HANDLE_TYPES","attachedCount","assign","prototype","_getServerProtocol","tlsClientError","getServerPaths","basePath","normalize","__dirname","index","_displayServerWelcome","listening","proto","_server$address","address","log","on","bind","_cmdMan","cmdMan","bindI","write","val","writeLn","error","promptTxt","cb","undefined","addCmd","runCmd","userMan","userManager","userFile","term","done","getUsers","then","users","args","username","_","hideInput","password","passwordAgain","createUser","deleteUser","user","curpwd","verifyUser","matches","setPassword","serverApp","name","_options$server","listen","remoteClients","onAuth","_sendMessages","clientSettings","sshOpts","Error","files","readdirSync","keyRe","hostKeys","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","file","test","push","err","length","keys","writeFileSync","SSHMan","monkey","cmdManager","result","_getCallerInfo","stack","getStack","map","frame","functionName","getFunctionName","methodName","getMethodName","fileName","getFileName","lineNumber","getLineNumber","columnNumber","getColumnNumber","caller","find","twoBack","sixBack","line","column","_sendMessage","info","callerInfo","shift","size","adapter","rooms","each","to","emit","decycle","forEach","Array","slice","_this","handlersActive","concat","serverOptions","handler","detachConsole","_this2","removeListener","instances","lastPort","get","set","_typeof2","_typeof3","origJSON","global","JSON","object","replacer","objects","paths","derez","path","i","nu","Boolean","Date","Number","RegExp","String","indexOf","$ref","isArray","element","stringify","retrocycle","$","px","rez","eval","item","BUNYAN_TRACE","BUNYAN_DEBUG","BUNYAN_INFO","BUNYAN_WARN","BUNYAN_ERROR","BUNYAN_FATAL","levelFromName","trace","debug","fatal","nameFromLevel","invert","inst","rec","parse","src","level","msg","func","_commonUtils","_commonUtils2","_sourceMapSupport","_sourceMapSupport2","parseCommand","str","reg","arr","match","exec","prep","prepareStackTrace","limit","stackTraceLimit","wrapCallSite","isObject","type","inverted","k","hasOwnProperty","_restify","_restify2","createServer","pre","userAgentConnection","use","gzipResponse","CORS","credentials","serveStatic","directory","createCmdMan","socket","promptId","prompts","cmdManOpts","pid","response","_socket","_socket2","io","ns","attach","of","creds","cmdId","command","output","message","handlers","event","CommandManager","commands","_promise","_promise2","_minimist","_minimist2","cmdName","ioInterface","boundI","constructor","key","Function","rawCommand","asUser","resolve","reject","parsed","cmd","SSHManager","clients","clientId","_ssh2","Server","readFileSync","onClient","SSHClient","session","stream","ptyInfo","inputActive","cmdHistory","onReady","onClose","_stringify","_stringify2","_ssh","_terminalKit","_terminalKit2","shutdown","close","_initCmdMan","bold","newline","nextLine","red","inputOpts","echo","inputField","style","end","ctx","_this3","accept","_this4","once","onWindowChange","_initStream","_initTerm","rows","columns","cols","onKey","data","clearScreen","_this5","isTTY","setRawMode","stdout","getWindowSize","createTerminal","stdin","stderr","generic","appName","crlf","windowTitle","_interpolate","varRe","vars","replace","clear","_this6","history","autoComplete","autoCompleteMenu","input","stringToBuffer","string","base","useNew","Buffer","from","UserManager","userFileCache","userFileCreated","usernames","env","_scrypt","_scrypt2","_readFile","code","setTimeout","guest","_writeFile","_hashPassword","passwd","kdfSync","N","r","toString","_verifyPassword","hash","verifyKdfSync","getUserData","_this7","userData"],"mappings":"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","file":"server.js","sourcesContent":["require(\"source-map-support\").install();\nmodule.exports = \n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _assign = __webpack_require__(1);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _getIterator2 = __webpack_require__(2);\n\t\n\tvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\t\n\tvar _keys = __webpack_require__(10);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _os = __webpack_require__(3);\n\t\n\tvar _os2 = _interopRequireDefault(_os);\n\t\n\tvar _fs = __webpack_require__(4);\n\t\n\tvar _fs2 = _interopRequireDefault(_fs);\n\t\n\tvar _path = __webpack_require__(5);\n\t\n\tvar _path2 = _interopRequireDefault(_path);\n\t\n\tvar _events = __webpack_require__(29);\n\t\n\tvar _events2 = _interopRequireDefault(_events);\n\t\n\tvar _child_process = __webpack_require__(6);\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _keypair = __webpack_require__(8);\n\t\n\tvar _keypair2 = _interopRequireDefault(_keypair);\n\t\n\tvar _cycle = __webpack_require__(9);\n\t\n\tvar _cycle2 = _interopRequireDefault(_cycle);\n\t\n\tvar _bunyanStream = __webpack_require__(12);\n\t\n\tvar _bunyanStream2 = _interopRequireDefault(_bunyanStream);\n\t\n\tvar _setupServer2 = __webpack_require__(15);\n\t\n\tvar _setupServer3 = _interopRequireDefault(_setupServer2);\n\t\n\tvar _setupSocket = __webpack_require__(17);\n\t\n\tvar _setupSocket2 = _interopRequireDefault(_setupSocket);\n\t\n\tvar _sshManager = __webpack_require__(22);\n\t\n\tvar _sshManager2 = _interopRequireDefault(_sshManager);\n\t\n\tvar _commandManager = __webpack_require__(19);\n\t\n\tvar _commandManager2 = _interopRequireDefault(_commandManager);\n\t\n\tvar _userManager = __webpack_require__(26);\n\t\n\tvar _userManager2 = _interopRequireDefault(_userManager);\n\t\n\tvar _utils = __webpack_require__(13);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar DEFAULT_PORT = 50500;\n\tvar CONSOLE = _lodash2.default.mapValues(console);\n\tvar ConsoleEvent = new _events2.default();\n\tvar HANDLE_TYPES = ['log', 'info', 'warn', 'error', 'dir'];\n\t\n\tvar attachedCount = 0;\n\t\n\tfunction NodeMonkey(opts) {\n\t  var NODE_ENV = process.NODE_ENV;\n\t  var options = this.options = _lodash2.default.merge({\n\t    server: {\n\t      // You can provide your own server and Node Monkey will use it instead of creating its own.\n\t      // However, this MUST be the underlying http server instance, not the express/restify/whatever app.\n\t      server: null,\n\t\n\t      host: '0.0.0.0',\n\t      port: DEFAULT_PORT,\n\t      silent: false,\n\t      bufferSize: 50,\n\t      attachOnStart: true,\n\t\n\t      // Only takes effect when Node Monkey is attached to the console\n\t      disableLocalOutput: false\n\t    },\n\t    client: {\n\t      showCallerInfo: NODE_ENV === 'production' ? false : true,\n\t      convertStyles: true\n\t    },\n\t    ssh: {\n\t      enabled: false,\n\t      host: '0.0.0.0',\n\t      port: DEFAULT_PORT + 1,\n\t      title: 'Node Monkey on ' + _os2.default.hostname(),\n\t      prompt: '[Node Monkey] {@username}@' + _os2.default.hostname() + ':'\n\t    },\n\t\n\t    // Needed for storing things like user files and SSH host keys\n\t    dataDir: null\n\t  }, opts);\n\t\n\t  this.msgBuffer = [];\n\t  this.BUNYAN_STREAM = (0, _bunyanStream2.default)(this);\n\t  this._attached = false;\n\t  this._typeHandlers = {};\n\t\n\t  this._createLocal();\n\t  this._createRemote();\n\t  this._setupCmdMan();\n\t  this._setupUserManager();\n\t  this._setupServer();\n\t  this._setupSSH();\n\t\n\t  if (options.server.attachOnStart) {\n\t    this.attachConsole();\n\t  }\n\t\n\t  // TODO: Deprecated. Remove everything after this line by v1.0.0\n\t  var self = this;\n\t  var warned = false;\n\t  function warnConsole() {\n\t    if (!warned) {\n\t      warned = true;\n\t      var warningMsg = ['[Deprecation Warning] Running Node Monkey with \\'augmentConsole\\' enabled.', 'This is strongly discouraged and will be removed in the v1.0.0 release.', 'See here for more info: https://github.com/jwarkentin/node-monkey/releases/tag/v1.0.0-rc.1'].join(' ');\n\t      self.local.warn(warningMsg);\n\t      self.remote.warn(warningMsg);\n\t    }\n\t  }\n\t\n\t  // This is here because webpack renames the function and for whatever reason the stack trace doesn't show the right name,\n\t  // even with proper source maps. This is all just temporary anyway so I'm hacking it.\n\t  Object.defineProperty(warnConsole, 'name', { value: 'warnConsole' });\n\t\n\t  console.local = _lodash2.default.mapValues(this.local, function (fn, method) {\n\t    var localFn = function localFn() {\n\t      warnConsole();\n\t      return fn.apply(console, arguments);\n\t    };\n\t    Object.defineProperty(localFn, 'name', { value: method });\n\t    return localFn;\n\t  });\n\t  console.remote = _lodash2.default.mapValues(this.remote, function (fn, method) {\n\t    var remoteFn = function remoteFn() {\n\t      warnConsole();\n\t      return fn.apply({ callerStackDistance: 2 }, arguments);\n\t    };\n\t    Object.defineProperty(remoteFn, 'name', { value: method });\n\t    return remoteFn;\n\t  });\n\t}\n\t\n\t_lodash2.default.assign(NodeMonkey.prototype, {\n\t  _getServerProtocol: function _getServerProtocol(server) {\n\t    if (server._events && server._events.tlsClientError) {\n\t      return 'https';\n\t    }\n\t    return 'http';\n\t  },\n\t  getServerPaths: function getServerPaths() {\n\t    var basePath = _path2.default.normalize(__dirname + '/../dist');\n\t\n\t    return {\n\t      basePath: basePath,\n\t      client: 'monkey.js',\n\t      index: 'index.html'\n\t    };\n\t  },\n\t  _displayServerWelcome: function _displayServerWelcome() {\n\t    if (!this.options.server.silent) {\n\t      var server = this.options.server.server;\n\t      if (server.listening) {\n\t        var proto = this._getServerProtocol(server);\n\t\n\t        var _server$address = server.address();\n\t\n\t        var address = _server$address.address;\n\t        var port = _server$address.port;\n\t\n\t        this.local.log('Node Monkey listening at ' + proto + '://' + address + ':' + port);\n\t      } else {\n\t        server.on('listening', this._displayServerWelcome.bind(this));\n\t      }\n\t    }\n\t  },\n\t  _setupCmdMan: function _setupCmdMan() {\n\t    this._cmdMan = new _commandManager2.default();\n\t    var cmdMan = this.cmdMan = this._cmdMan.bindI({\n\t      write: function write(val, opts) {\n\t        console.log(val);\n\t      },\n\t      writeLn: function writeLn(val, opts) {\n\t        console.log(val);\n\t      },\n\t      error: function error(val, opts) {\n\t        console.error(val);\n\t      },\n\t      prompt: function prompt(promptTxt, opts, cb) {\n\t        if (typeof opts === 'function') {\n\t          cb = opts;\n\t          opts = undefined;\n\t        }\n\t        opts || (opts = {});\n\t\n\t        console.warn('Prompt not implemented');\n\t      }\n\t    });\n\t\n\t    this.addCmd = cmdMan.addCmd;\n\t    this.runCmd = cmdMan.runCmd;\n\t  },\n\t  _setupUserManager: function _setupUserManager() {\n\t    var dataDir = this.options.dataDir;\n\t    var userMan = this.userManager = new _userManager2.default({\n\t      userFile: dataDir ? dataDir + '/users.json' : undefined,\n\t      silent: this.options.server.silent\n\t    });\n\t\n\t    this.cmdMan.addCmd('showusers', function (opts, term, done) {\n\t      var users = userMan.getUsers().then(function (users) {\n\t        term.writeLn((0, _keys2.default)(users).join('\\n'));\n\t        done();\n\t      });\n\t    });\n\t\n\t    this.cmdMan.addCmd('adduser', function (opts, term, done) {\n\t      var args = opts.args,\n\t          username = args._[0];\n\t\n\t      if (!username) {\n\t        term.error('You must specify a username');\n\t        return done();\n\t      }\n\t\n\t      term.prompt('Password: ', { hideInput: true }, function (error, password) {\n\t        term.writeLn();\n\t        term.prompt('Again: ', { hideInput: true }, function (error, passwordAgain) {\n\t          term.writeLn();\n\t          if (password === passwordAgain) {\n\t            userMan.createUser(username, password).then(function () {\n\t              return term.write('Created user \\'' + username + '\\'');\n\t            }).catch(term.error).then(done);\n\t          } else {\n\t            term.error('Passwords do not match');\n\t            done();\n\t          }\n\t        });\n\t      });\n\t    });\n\t\n\t    this.cmdMan.addCmd('deluser', function (opts, term, done) {\n\t      var args = opts.args,\n\t          username = args._[0];\n\t\n\t      if (!username) {\n\t        term.error('You must specify a username');\n\t        return done();\n\t      }\n\t\n\t      userMan.deleteUser(username).then(function () {\n\t        return term.write('Deleted user \\'' + username + '\\'');\n\t      }).catch(term.error).then(done);\n\t    });\n\t\n\t    this.cmdMan.addCmd('passwd', function (opts, term, done) {\n\t      var args = opts.args,\n\t          user = opts.username;\n\t\n\t      term.prompt('Current password: ', { hideInput: true }, function (error, curpwd) {\n\t        term.writeLn();\n\t        userMan.verifyUser(user, curpwd).then(function (matches) {\n\t          if (matches) {\n\t            term.prompt('Password: ', { hideInput: true }, function (error, password) {\n\t              term.writeLn();\n\t              term.prompt('Again: ', { hideInput: true }, function (error, passwordAgain) {\n\t                term.writeLn();\n\t                if (password === passwordAgain) {\n\t                  userMan.setPassword(user, password).then(function () {\n\t                    return term.write('Updated password for ' + user);\n\t                  }).catch(term.error).then(done);\n\t                } else {\n\t                  term.error('Passwords do not match');\n\t                  done();\n\t                }\n\t              });\n\t            });\n\t          } else {\n\t            term.error('Incorrect password');\n\t            done();\n\t          }\n\t        });\n\t      });\n\t    });\n\t  },\n\t  _setupServer: function _setupServer() {\n\t    var options = this.options,\n\t        server = options.server.server;\n\t\n\t    if (!server) {\n\t      var serverApp = (0, _setupServer3.default)({\n\t        name: 'Node Monkey'\n\t      });\n\t      server = this.options.server.server = serverApp.server;\n\t\n\t      var _options$server = options.server;\n\t      var host = _options$server.host;\n\t      var port = _options$server.port;\n\t\n\t      serverApp.listen(port, host);\n\t    }\n\t\n\t    this._displayServerWelcome();\n\t    this.serverApp = server;\n\t    this.remoteClients = (0, _setupSocket2.default)({\n\t      server: server.server || server,\n\t      userManager: this.userManager,\n\t      onAuth: this._sendMessages.bind(this),\n\t      clientSettings: options.client\n\t    });\n\t  },\n\t  _setupSSH: function _setupSSH() {\n\t    var sshOpts = this.options.ssh;\n\t    if (sshOpts.enabled) {\n\t      var dataDir = this.options.dataDir;\n\t      if (!dataDir) {\n\t        throw new Error('Options \\'dataDir\\' is required to enable SSH');\n\t      }\n\t\n\t      // Get host keys\n\t      var files = _fs2.default.readdirSync(dataDir),\n\t          keyRe = /\\.key$/,\n\t          hostKeys = [];\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = (0, _getIterator3.default)(files), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var file = _step.value;\n\t\n\t          if (keyRe.test(file)) {\n\t            hostKeys.push(dataDir + '/' + file);\n\t          }\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t\n\t      if (!hostKeys.length) {\n\t        console.log('No SSH host key found. Generating new host key...');\n\t        var keys = (0, _keypair2.default)();\n\t        _fs2.default.writeFileSync(dataDir + '/rsa.key', keys.private);\n\t        _fs2.default.writeFileSync(dataDir + '/rsa.key.pub', keys.public);\n\t        hostKeys = [dataDir + '/rsa.key'];\n\t      }\n\t\n\t      this.SSHMan = new _sshManager2.default({\n\t        monkey: this,\n\t        cmdManager: this._cmdMan,\n\t        userManager: this.userManager,\n\t        silent: this.options.server.silent,\n\t        host: sshOpts.host,\n\t        port: sshOpts.port,\n\t        title: _lodash2.default.result(sshOpts, 'title'),\n\t        prompt: _lodash2.default.result(sshOpts, 'prompt'),\n\t        hostKeys: hostKeys\n\t      });\n\t    }\n\t  },\n\t\n\t\n\t  // TODO: This whole process of trying to identify the true source of the call is so fucking messy and fragile. Need to think\n\t  //       of a better way to identify the call source and rewrite all this shitty code handling it right now.\n\t  _getCallerInfo: function _getCallerInfo(callerStackDistance) {\n\t    if (this.options.client.showCallerInfo) {\n\t      var stack = _utils2.default.getStack().map(function (frame) {\n\t        return {\n\t          functionName: frame.getFunctionName(),\n\t          methodName: frame.getMethodName(),\n\t          fileName: frame.getFileName(),\n\t          lineNumber: frame.getLineNumber(),\n\t          columnNumber: frame.getColumnNumber()\n\t        };\n\t      });\n\t\n\t      var caller = stack.find(function (frame, index, stack) {\n\t        // We're either looking for a console method call or a bunyan log call. This logic will break down if method names change.\n\t        var twoBack = stack[index - 2];\n\t        var sixBack = stack[index - 4];\n\t        if (twoBack && twoBack.functionName === 'Logger._emit' && /\\/bunyan\\.js$/.test(twoBack.fileName)) {\n\t          return true;\n\t        } else if (twoBack && sixBack && twoBack.methodName === 'emit' && sixBack.methodName === '_sendMessage') {\n\t          return true;\n\t        }\n\t      });\n\t\n\t      if (!caller && typeof callerStackDistance === 'number') {\n\t        caller = stack[callerStackDistance];\n\t      }\n\t\n\t      if (caller) {\n\t        return {\n\t          caller: caller.functionName || caller.methodName,\n\t          file: caller.fileName,\n\t          line: caller.lineNumber,\n\t          column: caller.columnNumber\n\t        };\n\t      }\n\t    }\n\t  },\n\t  _sendMessage: function _sendMessage(info, callerStackDistance) {\n\t    this.msgBuffer.push({\n\t      method: info.method,\n\t      args: info.args,\n\t      callerInfo: info.callerInfo || this._getCallerInfo(callerStackDistance + 1)\n\t    });\n\t    if (this.msgBuffer.length > this.options.server.bufferSize) {\n\t      this.msgBuffer.shift();\n\t    }\n\t    this._sendMessages();\n\t  },\n\t  _sendMessages: function _sendMessages() {\n\t    var remoteClients = this.remoteClients;\n\t    if (_lodash2.default.size(remoteClients.adapter.rooms['authed'])) {\n\t      _lodash2.default.each(this.msgBuffer, function (info) {\n\t        remoteClients.to('authed').emit('console', _cycle2.default.decycle(info));\n\t      });\n\t\n\t      this.msgBuffer = [];\n\t    }\n\t  },\n\t  _createLocal: function _createLocal() {\n\t    // NOTE: The console functions here should not be wrapped since these values are used to restore the defaults\n\t    //       when `detachConsole()` is called.\n\t    this.local = CONSOLE;\n\t  },\n\t  _createRemote: function _createRemote() {\n\t    var self = this;\n\t    var remote = this.remote = {};\n\t    HANDLE_TYPES.forEach(function (method) {\n\t      self.remote[method] = function () {\n\t        self._sendMessage({\n\t          method: method,\n\t          args: Array.prototype.slice.call(arguments)\n\t        }, this.callerStackDistance ? this.callerStackDistance + 1 : 2);\n\t      };\n\t      Object.defineProperty(remote[method], 'name', { value: method });\n\t    });\n\t  },\n\t  attachConsole: function attachConsole(disableLocalOutput) {\n\t    var _this = this;\n\t\n\t    if (this._attached) {\n\t      return;\n\t    }\n\t\n\t    if (!attachedCount) {\n\t      (function () {\n\t        // If this function is in the process of handling the log call we will try and prevent potential infinite recursion\n\t        var handlersActive = 0;\n\t        HANDLE_TYPES.forEach(function (method) {\n\t          console[method] = function () {\n\t            if (handlersActive) {\n\t              return self.local[method].apply(console, arguments);\n\t            }\n\t\n\t            ++handlersActive;\n\t            ConsoleEvent.emit.apply(ConsoleEvent, [method].concat(Array.prototype.slice.call(arguments)));\n\t            --handlersActive;\n\t          };\n\t          Object.defineProperty(console[method], 'name', { value: method });\n\t        });\n\t      })();\n\t    }\n\t\n\t    ++attachedCount;\n\t\n\t    var self = this;\n\t    var serverOptions = this.options.server;\n\t    disableLocalOutput = disableLocalOutput !== undefined ? disableLocalOutput : serverOptions.disableLocalOutput;\n\t\n\t    _lodash2.default.each(this.remote, function (fn, method) {\n\t      var handler = _this._typeHandlers[method] = function () {\n\t        fn.apply({ callerStackDistance: 5 }, arguments);\n\t\n\t        if (!disableLocalOutput) {\n\t          self.local[method].apply(console, arguments);\n\t        }\n\t      };\n\t      Object.defineProperty(handler, 'name', { value: method });\n\t\n\t      ConsoleEvent.on(method, handler);\n\t    });\n\t\n\t    this._attached = true;\n\t  },\n\t  detachConsole: function detachConsole() {\n\t    var _this2 = this;\n\t\n\t    (0, _assign2.default)(console, this.local);\n\t    this._attached = false;\n\t    --attachedCount;\n\t\n\t    HANDLE_TYPES.forEach(function (method) {\n\t      ConsoleEvent.removeListener(method, _this2._typeHandlers[method]);\n\t      delete _this2._typeHandlers[method];\n\t    });\n\t  }\n\t});\n\t\n\tvar instances = {};\n\tvar lastPort = DEFAULT_PORT - 1;\n\tmodule.exports = function createInst(options) {\n\t  var name = arguments.length <= 1 || arguments[1] === undefined ? 'default' : arguments[1];\n\t\n\t  if (typeof options === 'string') {\n\t    name = options;\n\t    options = undefined;\n\t  }\n\t\n\t  if (!instances[name]) {\n\t    options || (options = {});\n\t    var port = _lodash2.default.get(options, 'server.port');\n\t    if (port) {\n\t      lastPort = +port;\n\t    } else {\n\t      _lodash2.default.set(options, 'server.port', ++lastPort);\n\t      _lodash2.default.set(options, 'ssh.port', ++lastPort);\n\t    }\n\t    instances[name] = new NodeMonkey(options);\n\t  }\n\t\n\t  return instances[name];\n\t};\n\t\n\t// Just exporting in case someone needs to wrap this or access the internals for some reason\n\tmodule.exports.NodeMonkey = NodeMonkey;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/core-js/object/assign\");\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"os\");\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"fs\");\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"path\");\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"child_process\");\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"lodash\");\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"keypair\");\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _keys = __webpack_require__(10);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _typeof2 = __webpack_require__(11);\n\t\n\tvar _typeof3 = _interopRequireDefault(_typeof2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/*\n\t    cycle.js\n\t    2016-05-01\n\t\n\t    Public Domain.\n\t\n\t    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\t\n\t    This code should be minified before deployment.\n\t    See http://javascript.crockford.com/jsmin.html\n\t\n\t    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n\t    NOT CONTROL.\n\t*/\n\t\n\t/*jslint eval, for */\n\t\n\t/*property\n\t    $ref, decycle, forEach, isArray, keys, length, push, retrocycle, stringify,\n\t    test\n\t*/\n\t\n\tvar origJSON = global.JSON,\n\t    JSON = {};\n\tmodule.exports = JSON;\n\t\n\tif (typeof JSON.decycle !== \"function\") {\n\t    JSON.decycle = function decycle(object, replacer) {\n\t        \"use strict\";\n\t\n\t        // Make a deep copy of an object or array, assuring that there is at most\n\t        // one instance of each object or array in the resulting structure. The\n\t        // duplicate references (which might be forming cycles) are replaced with\n\t        // an object of the form\n\t\n\t        //      {\"$ref\": PATH}\n\t\n\t        // where the PATH is a JSONPath string that locates the first occurance.\n\t\n\t        // So,\n\t\n\t        //      var a = [];\n\t        //      a[0] = a;\n\t        //      return JSON.stringify(JSON.decycle(a));\n\t\n\t        // produces the string '[{\"$ref\":\"$\"}]'.\n\t\n\t        // If a replacer function is provided, then it will be called for each value.\n\t        // A replacer function receives a value and returns a replacement value.\n\t\n\t        // JSONPath is used to locate the unique object. $ indicates the top level of\n\t        // the object or array. [NUMBER] or [STRING] indicates a child element or\n\t        // property.\n\t\n\t        var objects = []; // Keep a reference to each unique object or array\n\t        var paths = []; // Keep the path to each unique object or array\n\t\n\t        return function derez(value, path) {\n\t\n\t            // The derez function recurses through the object, producing the deep copy.\n\t\n\t            var i; // The loop counter\n\t            var nu; // The new object or array\n\t\n\t            // If a replacer function was provided, then call it to get a replacement value.\n\t\n\t            if (replacer !== undefined) {\n\t                value = replacer(value);\n\t            }\n\t\n\t            // typeof null === \"object\", so go on if this value is really an object but not\n\t            // one of the weird builtin objects.\n\t\n\t            if ((typeof value === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(value)) === \"object\" && value !== null && !(value instanceof Boolean) && !(value instanceof Date) && !(value instanceof Number) && !(value instanceof RegExp) && !(value instanceof String)) {\n\t\n\t                // If the value is an object or array, look to see if we have already\n\t                // encountered it. If so, return a {\"$ref\":PATH} object. This is a hard\n\t                // linear search that will get slower as the number of unique objects grows.\n\t                // Someday, this should be replaced with an ES6 WeakMap.\n\t\n\t                i = objects.indexOf(value);\n\t                if (i >= 0) {\n\t                    return { $ref: paths[i] };\n\t                }\n\t\n\t                // Otherwise, accumulate the unique value and its path.\n\t\n\t                objects.push(value);\n\t                paths.push(path);\n\t\n\t                // If it is an array, replicate the array.\n\t\n\t                if (Array.isArray(value)) {\n\t                    nu = [];\n\t                    value.forEach(function (element, i) {\n\t                        nu[i] = derez(element, path + \"[\" + i + \"]\");\n\t                    });\n\t                } else {\n\t\n\t                    // If it is an object, replicate the object.\n\t\n\t                    nu = {};\n\t                    (0, _keys2.default)(value).forEach(function (name) {\n\t                        nu[name] = derez(value[name], path + \"[\" + JSON.stringify(name) + \"]\");\n\t                    });\n\t                }\n\t                return nu;\n\t            }\n\t            return value;\n\t        }(object, \"$\");\n\t    };\n\t}\n\t\n\tif (typeof JSON.retrocycle !== \"function\") {\n\t    JSON.retrocycle = function retrocycle($) {\n\t        \"use strict\";\n\t\n\t        // Restore an object that was reduced by decycle. Members whose values are\n\t        // objects of the form\n\t        //      {$ref: PATH}\n\t        // are replaced with references to the value found by the PATH. This will\n\t        // restore cycles. The object will be mutated.\n\t\n\t        // The eval function is used to locate the values described by a PATH. The\n\t        // root object is kept in a $ variable. A regular expression is used to\n\t        // assure that the PATH is extremely well formed. The regexp contains nested\n\t        // * quantifiers. That has been known to have extremely bad performance\n\t        // problems on some browsers for very long strings. A PATH is expected to be\n\t        // reasonably short. A PATH is allowed to belong to a very restricted subset of\n\t        // Goessner's JSONPath.\n\t\n\t        // So,\n\t        //      var s = '[{\"$ref\":\"$\"}]';\n\t        //      return JSON.retrocycle(JSON.parse(s));\n\t        // produces an array containing a single element which is the array itself.\n\t\n\t        var px = /^\\$(?:\\[(?:\\d+|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\n\t\n\t        (function rez(value) {\n\t\n\t            // The rez function walks recursively through the object looking for $ref\n\t            // properties. When it finds one that has a value that is a path, then it\n\t            // replaces the $ref object with a reference to the value that is found by\n\t            // the path.\n\t\n\t            if (value && (typeof value === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(value)) === \"object\") {\n\t                if (Array.isArray(value)) {\n\t                    value.forEach(function (element, i) {\n\t                        if ((typeof element === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(element)) === \"object\" && element !== null) {\n\t                            var path = element.$ref;\n\t                            if (typeof path === \"string\" && px.test(path)) {\n\t                                value[i] = eval(path);\n\t                            } else {\n\t                                rez(element);\n\t                            }\n\t                        }\n\t                    });\n\t                } else {\n\t                    (0, _keys2.default)(value).forEach(function (name) {\n\t                        var item = value[name];\n\t                        if ((typeof item === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(item)) === \"object\" && item !== null) {\n\t                            var path = item.$ref;\n\t                            if (typeof path === \"string\" && px.test(path)) {\n\t                                value[name] = eval(path);\n\t                            } else {\n\t                                rez(item);\n\t                            }\n\t                        }\n\t                    });\n\t                }\n\t            }\n\t        })($);\n\t        return $;\n\t    };\n\t}\n\t\n\tJSON = origJSON;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/core-js/object/keys\");\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/helpers/typeof\");\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _utils = __webpack_require__(13);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar BUNYAN_TRACE = 10;\n\tvar BUNYAN_DEBUG = 20;\n\tvar BUNYAN_INFO = 30;\n\tvar BUNYAN_WARN = 40;\n\tvar BUNYAN_ERROR = 50;\n\tvar BUNYAN_FATAL = 60;\n\t\n\tvar levelFromName = {\n\t  'trace': BUNYAN_TRACE,\n\t  'debug': BUNYAN_DEBUG,\n\t  'info': BUNYAN_INFO,\n\t  'warn': BUNYAN_WARN,\n\t  'error': BUNYAN_ERROR,\n\t  'fatal': BUNYAN_FATAL\n\t},\n\t    nameFromLevel = _utils2.default.invert(levelFromName);\n\t\n\texports.default = function (inst) {\n\t  return {\n\t    write: function write(rec) {\n\t      // TODO: Look for the first call that didn't originate in bunyan.js\n\t      rec = JSON.parse(rec);\n\t      var src = rec.src;\n\t      inst._sendMessage({\n\t        method: nameFromLevel[rec.level] || 'info',\n\t        args: [rec.msg, rec],\n\t        callerInfo: src && {\n\t          caller: src.func || 'anonymous',\n\t          file: src.file,\n\t          line: src.line,\n\t          column: 0\n\t        }\n\t      });\n\t    }\n\t  };\n\t};\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _assign = __webpack_require__(1);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _commonUtils = __webpack_require__(14);\n\t\n\tvar _commonUtils2 = _interopRequireDefault(_commonUtils);\n\t\n\tvar _sourceMapSupport = __webpack_require__(30);\n\t\n\tvar _sourceMapSupport2 = _interopRequireDefault(_sourceMapSupport);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = (0, _assign2.default)({\n\t  parseCommand: function parseCommand(str) {\n\t    var reg = /\"(.*?)\"|'(.*?)'|`(.*?)`|([^\\s\"]+)/gi;\n\t    var arr = [],\n\t        match = void 0;\n\t\n\t    do {\n\t      match = reg.exec(str);\n\t      if (match !== null) {\n\t        arr.push(match[1] || match[2] || match[3] || match[4]);\n\t      }\n\t    } while (match !== null);\n\t\n\t    return arr;\n\t  },\n\t  getStack: function getStack() {\n\t    var prep = Error.prepareStackTrace;\n\t    var limit = Error.stackTraceLimit;\n\t    Error.prepareStackTrace = function (error, trace) {\n\t      return trace.map(_sourceMapSupport2.default.wrapCallSite);\n\t    };\n\t    Error.stackTraceLimit = 30;\n\t\n\t    var stack = new Error().stack;\n\t    Error.prepareStackTrace = prep;\n\t    Error.stackTraceLimit = limit;\n\t\n\t    return stack.slice(1);\n\t  }\n\t}, _commonUtils2.default);\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _typeof2 = __webpack_require__(11);\n\t\n\tvar _typeof3 = _interopRequireDefault(_typeof2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = {\n\t  isObject: function isObject(value) {\n\t    var type = typeof value === 'undefined' ? 'undefined' : (0, _typeof3.default)(value);\n\t    return !!value && (type == 'object' || type == 'function');\n\t  },\n\t  invert: function invert(obj) {\n\t    var inverted = {};\n\t    for (var k in obj) {\n\t      if (obj.hasOwnProperty(k)) {\n\t        inverted[obj[k]] = k;\n\t      }\n\t    }\n\t\n\t    return inverted;\n\t  }\n\t};\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _restify = __webpack_require__(16);\n\t\n\tvar _restify2 = _interopRequireDefault(_restify);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = function (options) {\n\t  var server = _restify2.default.createServer();\n\t\n\t  server.pre(_restify2.default.pre.userAgentConnection());\n\t  server.use(_restify2.default.gzipResponse());\n\t  server.use(_restify2.default.CORS({\n\t    credentials: true\n\t  }));\n\t\n\t  server.get(/.*/, _restify2.default.serveStatic({\n\t    directory: __dirname,\n\t    default: 'index.html'\n\t  }));\n\t\n\t  return server;\n\t};\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"restify\");\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _socket = __webpack_require__(18);\n\t\n\tvar _socket2 = _interopRequireDefault(_socket);\n\t\n\tvar _commandManager = __webpack_require__(19);\n\t\n\tvar _commandManager2 = _interopRequireDefault(_commandManager);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = function (options) {\n\t  var io = void 0,\n\t      ns = void 0;\n\t  var userManager = options.userManager;\n\t\n\t  if (typeof options.server === 'function') {\n\t    io = (0, _socket2.default)(options.server);\n\t  } else {\n\t    io = (0, _socket2.default)();\n\t    io.attach(options.server);\n\t  }\n\t\n\t  ns = io.of('/nm');\n\t  ns.on('connection', function (socket) {\n\t    var cmdMan = null;\n\t    socket.emit('settings', options.clientSettings);\n\t    socket.emit('auth');\n\t\n\t    socket.on('auth', function (creds) {\n\t      userManager.verifyUser(creds.username, creds.password).then(function (result) {\n\t        socket.emit('authResponse', result, result ? undefined : 'Incorrect password');\n\t        if (result) {\n\t          socket.username = creds.username;\n\t          socket.join('authed');\n\t          if (options.onAuth) {\n\t            options.onAuth(socket);\n\t          }\n\t        }\n\t      }).catch(function (err) {\n\t        socket.emit('authResponse', false, err);\n\t      });\n\t    });\n\t\n\t    socket.on('cmd', function (cmdId, command) {\n\t      if (!socket.username) {\n\t        socket.emit('cmdResponse', cmdId, 'You are not authorized to run commands');\n\t        return;\n\t      }\n\t\n\t      if (!cmdMan) {\n\t        cmdMan = createCmdMan(socket);\n\t      }\n\t\n\t      cmdMan.runCmd(command, socket.username).then(function (output) {\n\t        socket.emit('cmdResponse', cmdId, null, output);\n\t      }).catch(function (err) {\n\t        socket.emit('cmdResponse', cmdId, err && err.message || err, null);\n\t      });\n\t    });\n\t  });\n\t\n\t  _lodash2.default.each(options.handlers, function (handler, event) {\n\t    io.on(event, handler);\n\t  });\n\t\n\t  return ns;\n\t};\n\t\n\tfunction createCmdMan(socket) {\n\t  var promptId = 0,\n\t      prompts = {};\n\t\n\t  var cmdManOpts = {\n\t    writeLn: null,\n\t    write: function write(val, opts) {\n\t      if (!val) return;\n\t\n\t      socket.emit('console', {\n\t        method: 'log',\n\t        args: [val]\n\t      });\n\t    },\n\t    error: function error(val, opts) {\n\t      if (!val) return;\n\t\n\t      socket.emit('console', {\n\t        method: 'error',\n\t        args: [val]\n\t      });\n\t    },\n\t    prompt: function prompt(promptTxt, opts, cb) {\n\t      if (typeof opts === 'function') {\n\t        cb = opts;\n\t        opts = undefined;\n\t      }\n\t      opts || (opts = {});\n\t\n\t      var pid = promptId++;\n\t      socket.emit('prompt', pid, promptTxt, opts);\n\t\n\t      prompts[pid] = cb;\n\t    }\n\t  };\n\t  cmdManOpts.writeLn = cmdManOpts.write;\n\t\n\t  socket.on('promptResponse', function (promptId, response) {\n\t    if (prompts[promptId]) {\n\t      prompts[promptId](null, response);\n\t    }\n\t  });\n\t\n\t  return new _commandManager2.default(cmdManOpts);\n\t}\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"socket.io\");\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _promise = __webpack_require__(20);\n\t\n\tvar _promise2 = _interopRequireDefault(_promise);\n\t\n\tvar _assign = __webpack_require__(1);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _utils = __webpack_require__(13);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _minimist = __webpack_require__(21);\n\t\n\tvar _minimist2 = _interopRequireDefault(_minimist);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction CommandManager() {\n\t  this.commands = {};\n\t}\n\t\n\t(0, _assign2.default)(CommandManager.prototype, {\n\t  addCmd: function addCmd(cmdName, opts, exec) {\n\t    if (this.commands[cmdName]) {\n\t      throw new Error('\\'' + cmdName + '\\' is already registered as a command');\n\t    }\n\t\n\t    if (typeof opts === 'function') {\n\t      exec = opts;\n\t      opts = {};\n\t    }\n\t\n\t    this.commands[cmdName] = {\n\t      opts: opts,\n\t      exec: exec\n\t    };\n\t  },\n\t  bindI: function bindI(ioInterface) {\n\t    var _this = this;\n\t\n\t    var boundI = _lodash2.default.mapValues(this);\n\t    (0, _assign2.default)(boundI, _lodash2.default.mapValues(this.constructor.prototype, function (val, key) {\n\t      if (val instanceof Function) {\n\t        if (key === 'runCmd') {\n\t          return val.bind(_this, ioInterface);\n\t        }\n\t        return val.bind(_this);\n\t      } else {\n\t        return val;\n\t      }\n\t    }));\n\t\n\t    return boundI;\n\t  },\n\t  runCmd: function runCmd(io, rawCommand, asUser) {\n\t    var _this2 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      var parsed = _utils2.default.parseCommand(rawCommand),\n\t          cmdName = parsed[0],\n\t          cmd = _this2.commands[cmdName];\n\t\n\t      if (!asUser) {\n\t        return reject('Missing user context for command \\'' + cmdName + '\\'');\n\t      }\n\t\n\t      if (!cmd) {\n\t        return reject('Command not found: \\'' + cmdName + '\\'');\n\t      }\n\t\n\t      var args = (0, _minimist2.default)(parsed.slice(1));\n\t      cmd.exec({\n\t        args: args,\n\t        username: asUser\n\t      }, {\n\t        write: io.write,\n\t        writeLn: io.writeLn,\n\t        error: io.error,\n\t        prompt: io.prompt\n\t      }, resolve);\n\t    });\n\t  }\n\t});\n\t\n\texports.default = CommandManager;\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/core-js/promise\");\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"minimist\");\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _stringify = __webpack_require__(23);\n\t\n\tvar _stringify2 = _interopRequireDefault(_stringify);\n\t\n\tvar _keys = __webpack_require__(10);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _getIterator2 = __webpack_require__(2);\n\t\n\tvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\t\n\tvar _assign = __webpack_require__(1);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _fs = __webpack_require__(4);\n\t\n\tvar _fs2 = _interopRequireDefault(_fs);\n\t\n\tvar _ssh = __webpack_require__(24);\n\t\n\tvar _ssh2 = _interopRequireDefault(_ssh);\n\t\n\tvar _terminalKit = __webpack_require__(25);\n\t\n\tvar _terminalKit2 = _interopRequireDefault(_terminalKit);\n\t\n\tvar _commandManager = __webpack_require__(19);\n\t\n\tvar _commandManager2 = _interopRequireDefault(_commandManager);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction SSHManager(options) {\n\t  this.options = options = (0, _assign2.default)({\n\t    host: '127.0.0.1',\n\t    port: 50501,\n\t    title: 'Node Monkey',\n\t    prompt: 'Node Monkey:',\n\t    silent: false\n\t  }, options);\n\t\n\t  this.clients = {};\n\t  this.clientId = 1;\n\t\n\t  this.server = _ssh2.default.Server({\n\t    hostKeys: options.hostKeys.map(function (file) {\n\t      return _fs2.default.readFileSync(file);\n\t    })\n\t  }, this.onClient.bind(this));\n\t\n\t  var monkey = this.options.monkey;\n\t  this.server.listen(options.port, options.host, function () {\n\t    options.silent || monkey.local.log('SSH listening on ' + this.address().port);\n\t  });\n\t}\n\t\n\t(0, _assign2.default)(SSHManager.prototype, {\n\t  shutdown: function shutdown() {\n\t    var clients = this.clients;\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t      for (var _iterator = (0, _getIterator3.default)(clients), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t        var c = _step.value;\n\t\n\t        c.write('\\nShutting down');\n\t        c.close();\n\t      }\n\t    } catch (err) {\n\t      _didIteratorError = true;\n\t      _iteratorError = err;\n\t    } finally {\n\t      try {\n\t        if (!_iteratorNormalCompletion && _iterator.return) {\n\t          _iterator.return();\n\t        }\n\t      } finally {\n\t        if (_didIteratorError) {\n\t          throw _iteratorError;\n\t        }\n\t      }\n\t    }\n\t  },\n\t  onClient: function onClient(client) {\n\t    var _this = this;\n\t\n\t    var clientId = clientId++;\n\t    this.clients[clientId] = new SSHClient({\n\t      client: client,\n\t      cmdManager: this.options.cmdManager,\n\t      userManager: this.options.userManager,\n\t      title: this.options.title,\n\t      prompt: this.options.prompt,\n\t      onClose: function onClose() {\n\t        return delete _this.clients[clientId];\n\t      }\n\t    });\n\t  }\n\t});\n\t\n\tfunction SSHClient(options) {\n\t  this.options = options;\n\t  this.client = options.client;\n\t  this.cmdMan = null;\n\t  this.userManager = options.userManager;\n\t  this.session = null;\n\t  this.stream = null;\n\t  this.term = null;\n\t  this.ptyInfo = null;\n\t\n\t  this.title = options.title;\n\t  this.promptTxt = options.prompt + ' ';\n\t  this.inputActive = false;\n\t  this.cmdHistory = [];\n\t\n\t  this.username = null;\n\t\n\t  this.client.on('authentication', this.onAuth.bind(this));\n\t  this.client.on('ready', this.onReady.bind(this));\n\t  this.client.on('end', this.onClose.bind(this));\n\t}\n\t\n\t(0, _assign2.default)(SSHClient.prototype, {\n\t  _initCmdMan: function _initCmdMan() {\n\t    var _this2 = this;\n\t\n\t    var cmdManOpts = {\n\t      writeLn: null,\n\t      write: function write(val, opts) {\n\t        opts || (opts = {});\n\t        val || (val = '');\n\t\n\t        if (opts.bold) {\n\t          _this2.term.bold(val);\n\t        } else {\n\t          _this2.term(val);\n\t        }\n\t\n\t        if (opts.newline) {\n\t          _this2.term.nextLine();\n\t        }\n\t      },\n\t      error: function error(val, opts) {\n\t        opts || (opts = {});\n\t\n\t        // TODO: Apparently by sending this to stdout there is a timing issue and anything send to\n\t        //       stdout appears before this value is send to stderr for some reason.\n\t        // this.term.red.error(val)\n\t        _this2.term.red(val);\n\t\n\t        if (opts.newline) {\n\t          _this2.term.nextLine();\n\t        }\n\t      },\n\t      prompt: function prompt() {\n\t        var promptTxt = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\t        var opts = arguments[1];\n\t        var cb = arguments[2];\n\t\n\t        if (typeof opts === 'function') {\n\t          cb = opts;\n\t          opts = undefined;\n\t        }\n\t        opts || (opts = {});\n\t\n\t        var inputOpts = {};\n\t        if (opts.hideInput) {\n\t          inputOpts.echo = false;\n\t        }\n\t\n\t        _this2.term(promptTxt);\n\t        _this2.term.inputField(inputOpts, cb);\n\t      }\n\t    };\n\t    cmdManOpts.writeLn = function (val, opts) {\n\t      opts || (opts = {});\n\t      opts.newline = true;\n\t      cmdManOpts.write(val, opts);\n\t    };\n\t    this.cmdMan = this.options.cmdManager.bindI(cmdManOpts);\n\t  },\n\t  write: function write(msg, opts) {\n\t    opts || (opts = {});\n\t    if (this.term) {\n\t      if (opts.style) {\n\t        this.term[style](msg);\n\t      } else {\n\t        this.term(msg);\n\t      }\n\t    }\n\t  },\n\t  close: function close() {\n\t    if (this.stream) {\n\t      this.stream.end();\n\t    }\n\t    this.onClose();\n\t  },\n\t  onAuth: function onAuth(ctx) {\n\t    var _this3 = this;\n\t\n\t    if (ctx.method == 'password') {\n\t      this.userManager.verifyUser(ctx.username, ctx.password).then(function (result) {\n\t        if (result) {\n\t          _this3.username = ctx.username;\n\t          ctx.accept();\n\t        } else {\n\t          ctx.reject();\n\t        }\n\t      }).catch(function (err) {\n\t        ctx.reject();\n\t      });\n\t    } else if (ctx.method == 'publickey') {\n\t      ctx.reject();\n\t    } else {\n\t      ctx.reject();\n\t    }\n\t  },\n\t  onReady: function onReady() {\n\t    var _this4 = this;\n\t\n\t    this.client.on('session', function (accept, reject) {\n\t      _this4.session = accept();\n\t\n\t      _this4.session.once('pty', function (accept, reject, info) {\n\t        _this4.ptyInfo = info;\n\t        accept && accept();\n\t      }).on('window-change', _this4.onWindowChange.bind(_this4)).once('shell', function (accept, reject) {\n\t        _this4.stream = accept();\n\t        _this4._initCmdMan();\n\t        _this4._initStream();\n\t        _this4._initTerm();\n\t      });\n\t    });\n\t  },\n\t  onWindowChange: function onWindowChange(accept, reject, info) {\n\t    var stream = this.stream;\n\t    (0, _assign2.default)(this.ptyInfo, info);\n\t    if (stream) {\n\t      stream.rows = info.rows;\n\t      stream.columns = info.cols;\n\t      stream.emit('resize');\n\t    }\n\t    accept && accept();\n\t  },\n\t  onClose: function onClose() {\n\t    var onClose = this.options.onClose;\n\t    onClose && onClose();\n\t  },\n\t  onKey: function onKey(name, matches, data) {\n\t    if (name === 'CTRL_L') {\n\t      this.clearScreen();\n\t    } else if (name === 'CTRL_D') {\n\t      this.term.nextLine();\n\t      this.close();\n\t    }\n\t  },\n\t  _initStream: function _initStream() {\n\t    var _this5 = this;\n\t\n\t    var stream = this.stream;\n\t    stream.name = this.title;\n\t    stream.rows = this.ptyInfo.rows || 24;\n\t    stream.columns = this.ptyInfo.cols || 80;\n\t    stream.isTTY = true;\n\t    stream.setRawMode = function () {};\n\t    stream.on('error', function (error) {\n\t      console.error('SSH stream error:', error.message);\n\t    });\n\t    stream.stdout.getWindowSize = function () {\n\t      return [_this5.ptyInfo.cols, _this5.ptyInfo.rows];\n\t    };\n\t  },\n\t  _initTerm: function _initTerm() {\n\t    var stream = this.stream;\n\t\n\t    var term = this.term = _terminalKit2.default.createTerminal({\n\t      stdin: stream.stdin,\n\t      stdout: stream.stdout,\n\t      stderr: stream.stderr,\n\t      generic: this.ptyInfo.term,\n\t      appName: this.title\n\t    });\n\t    term.options.crlf = true;\n\t\n\t    term.on('key', this.onKey.bind(this));\n\t    term.windowTitle(this._interpolate(this.title));\n\t    this.clearScreen();\n\t  },\n\t  _interpolate: function _interpolate(str) {\n\t    var varRe = /{@(.+?)}/g;\n\t    var vars = {\n\t      username: this.username\n\t    };\n\t\n\t    var match = void 0;\n\t    while (match = varRe.exec(str)) {\n\t      if (vars[match[1]]) {\n\t        str = str.replace(match[0], vars[match[1]]);\n\t      }\n\t    }\n\t\n\t    return str;\n\t  },\n\t  clearScreen: function clearScreen() {\n\t    this.term.clear();\n\t    this.prompt();\n\t  },\n\t  prompt: function prompt() {\n\t    var _this6 = this;\n\t\n\t    var term = this.term;\n\t    term.windowTitle(this._interpolate(this.title));\n\t    term.bold(this._interpolate(this.promptTxt));\n\t\n\t    if (!this.inputActive) {\n\t      this.inputActive = true;\n\t      term.inputField({\n\t        history: this.cmdHistory,\n\t        autoComplete: (0, _keys2.default)(this.cmdMan.commands),\n\t        autoCompleteMenu: true\n\t      }, function (error, input) {\n\t        _this6.inputActive = false;\n\t        input[0] !== ' ' && _this6.cmdHistory.push(input);\n\t        term.nextLine();\n\t\n\t        if (input === 'exit') {\n\t          _this6.close();\n\t        } else if (input === 'clear') {\n\t          _this6.clearScreen();\n\t        } else if (input) {\n\t          _this6.cmdMan.runCmd(input, _this6.username).then(function (output) {\n\t            if (typeof output !== 'string') {\n\t              output = (0, _stringify2.default)(output, null, '  ');\n\t            }\n\t            _this6.term(output);\n\t            _this6.term.nextLine();\n\t            _this6.prompt();\n\t          }).catch(function (err) {\n\t            if (typeof err !== 'string') {\n\t              err = err.message || (0, _stringify2.default)(err, null, '  ');\n\t            }\n\t            _this6.term.red.error(err);\n\t            _this6.term.nextLine();\n\t            _this6.prompt();\n\t          });\n\t        } else {\n\t          _this6.prompt();\n\t        }\n\t      });\n\t    }\n\t  }\n\t});\n\t\n\texports.default = SSHManager;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n/***/ },\n/* 24 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"ssh2\");\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"terminal-kit\");\n\n/***/ },\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _promise = __webpack_require__(20);\n\t\n\tvar _promise2 = _interopRequireDefault(_promise);\n\t\n\tvar _stringify = __webpack_require__(23);\n\t\n\tvar _stringify2 = _interopRequireDefault(_stringify);\n\t\n\tvar _assign = __webpack_require__(1);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _keys = __webpack_require__(10);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _fs = __webpack_require__(4);\n\t\n\tvar _fs2 = _interopRequireDefault(_fs);\n\t\n\tvar _scrypt = __webpack_require__(27);\n\t\n\tvar _scrypt2 = _interopRequireDefault(_scrypt);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar useNew = false;\n\ttry {\n\t  Buffer.from('', 'base64');\n\t} catch (err) {\n\t  useNew = true;\n\t}\n\t\n\tfunction stringToBuffer(string, base) {\n\t  if (useNew) {\n\t    return new Buffer(string, base);\n\t  } else {\n\t    return Buffer.from(string, base);\n\t  }\n\t}\n\t\n\tfunction UserManager(options) {\n\t  this.userFile = options.userFile;\n\t  this.userFileCache = null;\n\t  this.userFileCreated = false;\n\t\n\t  if (!options.silent) {\n\t    this.getUsers().then(function (users) {\n\t      var usernames = (0, _keys2.default)(users);\n\t      if (!usernames.length) {\n\t        if (process.env.NODE_ENV === 'production') {\n\t          console.warn('No users have been created and you are running in production mode so you will not be able to login.\\n');\n\t        } else {\n\t          console.warn('It seems there are no users and you are not running in production mode so you will not be able to login. This is probably a bug. Please report it!\\n');\n\t        }\n\t      } else if (usernames.length === 1 && usernames[0] === 'guest') {\n\t        console.warn('[WARN] No users detected. You can login with default user \\'guest\\' and password \\'guest\\' when prompted.\\n' + 'This user will be disabled when you create a user account.\\n');\n\t      }\n\t    });\n\t  }\n\t}\n\t\n\t(0, _assign2.default)(UserManager.prototype, {\n\t  _readFile: function _readFile() {\n\t    var _this = this;\n\t\n\t    if (this.userFileCache) {\n\t      return this.userFileCache;\n\t    }\n\t\n\t    try {\n\t      if (!this.userFile) {\n\t        var err = new Error('No user file specified');\n\t        err.code = 'ENOENT';\n\t        throw err;\n\t      }\n\t\n\t      this.userFileCache = JSON.parse(_fs2.default.readFileSync(this.userFile));\n\t      this.userFileCreated = true;\n\t      setTimeout(function () {\n\t        _this.userFileCache = null;\n\t      }, 5000);\n\t\n\t      return this.userFileCache;\n\t    } catch (err) {\n\t      if (err.code === 'ENOENT') {\n\t        return process.env.NODE_ENV === 'production' ? {} : {\n\t          guest: {\n\t            password: 'c2NyeXB0AAEAAAABAAAAAZS+vE1+zh4nY6vN21zM3dIzpJVImr8OrK0iJoA+iUPk7WIdo3RhgeATzWENocd7gKNbEKVgq6LbXqrmVjLtnYy5FXyfRCtEtmjUuj19AqcW'\n\t          }\n\t        };\n\t      }\n\t      throw err;\n\t    }\n\t  },\n\t  _writeFile: function _writeFile(data) {\n\t    this.userFileCache = null;\n\t    _fs2.default.writeFileSync(this.userFile, (0, _stringify2.default)(data, null, '  '));\n\t    this.userFileCreated = true;\n\t  },\n\t  _hashPassword: function _hashPassword(passwd) {\n\t    return _scrypt2.default.kdfSync(passwd.normalize('NFKC'), { N: 1, r: 1, p: 1 }).toString('base64');\n\t  },\n\t  _verifyPassword: function _verifyPassword(hash, passwd) {\n\t    return _scrypt2.default.verifyKdfSync(stringToBuffer(hash, 'base64'), passwd.normalize('NFKC'));\n\t  },\n\t  createUser: function createUser(username, password) {\n\t    var _this2 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      if (!_this2.userFile) {\n\t        return reject(new Error('No user file found. Did you forget to set the \\'dataDir\\' option?'));\n\t      }\n\t\n\t      var users = _this2._readFile();\n\t      if (users[username]) {\n\t        return reject(new Error('User \\'' + username + '\\' already exists'));\n\t      }\n\t\n\t      if (!_this2.userFileCreated) {\n\t        delete users['guest'];\n\t      }\n\t\n\t      users[username] = {\n\t        password: _this2._hashPassword(password)\n\t      };\n\t      _this2._writeFile(users);\n\t      resolve();\n\t    });\n\t  },\n\t  deleteUser: function deleteUser(username) {\n\t    var _this3 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      if (!_this3.userFile) {\n\t        return reject(new Error('No user file found. Did you forget to set the \\'dataDir\\' option?'));\n\t      }\n\t\n\t      var users = _this3._readFile();\n\t      if (!users[username]) {\n\t        return reject(new Error('User \\'' + username + '\\' does not exist'));\n\t      }\n\t\n\t      if (!_this3.userFileCreated) {\n\t        return reject(new Error('User file has not been created'));\n\t      }\n\t\n\t      delete users[username];\n\t      _this3._writeFile(users);\n\t      resolve();\n\t    });\n\t  },\n\t  setPassword: function setPassword(username, password) {\n\t    var _this4 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      if (!_this4.userFile) {\n\t        return reject(new Error('No user file found. Did you forget to set the \\'dataDir\\' option?'));\n\t      }\n\t\n\t      var users = _this4._readFile();\n\t\n\t      users[username].password = _this4._hashPassword(password);\n\t      _this4._writeFile(users);\n\t      resolve();\n\t    });\n\t  },\n\t  getUsers: function getUsers() {\n\t    var _this5 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      resolve(_this5._readFile());\n\t    });\n\t  },\n\t  getUserData: function getUserData(username) {\n\t    var _this6 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      var users = _this6._readFile();\n\t      if (!users[username]) {\n\t        return reject(new Error('User \\'' + username + '\\' does not exist'));\n\t      }\n\t\n\t      resolve(users[username]);\n\t    });\n\t  },\n\t  verifyUser: function verifyUser(username, passwd) {\n\t    var _this7 = this;\n\t\n\t    return new _promise2.default(function (resolve, reject) {\n\t      _this7.getUserData(username).then(function (userData) {\n\t        resolve(_this7._verifyPassword(userData.password, passwd));\n\t      }).catch(reject);\n\t    });\n\t  }\n\t});\n\t\n\texports.default = UserManager;\n\n/***/ },\n/* 27 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"scrypt\");\n\n/***/ },\n/* 28 */,\n/* 29 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"events\");\n\n/***/ },\n/* 30 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"source-map-support\");\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** server.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e325875d596869d0b30a\n **/","import os from 'os'\nimport fs from 'fs'\nimport path from 'path'\nimport EventEmitter from 'events'\nimport { execSync } from 'child_process'\nimport _ from 'lodash'\nimport keypair from 'keypair'\nimport cycle from '../lib/cycle'\nimport bunyanStream from './bunyan-stream'\nimport setupServer from './setup-server'\nimport setupSocket from './setup-socket'\nimport SSHMan from './ssh-manager'\nimport CmdMan from './command-manager'\nimport UserManager from './user-manager'\nimport utils from './utils'\n\nconst DEFAULT_PORT = 50500\nconst CONSOLE = _.mapValues(console)\nconst ConsoleEvent = new EventEmitter()\nconst HANDLE_TYPES = [ 'log', 'info', 'warn', 'error', 'dir' ]\n\nlet attachedCount = 0\n\nfunction NodeMonkey(opts) {\n  const NODE_ENV = process.NODE_ENV\n  let options = this.options = _.merge({\n    server: {\n      // You can provide your own server and Node Monkey will use it instead of creating its own.\n      // However, this MUST be the underlying http server instance, not the express/restify/whatever app.\n      server: null,\n\n      host: '0.0.0.0',\n      port: DEFAULT_PORT,\n      silent: false,\n      bufferSize: 50,\n      attachOnStart: true,\n\n      // Only takes effect when Node Monkey is attached to the console\n      disableLocalOutput: false\n    },\n    client: {\n      showCallerInfo: NODE_ENV === 'production' ? false : true,\n      convertStyles: true\n    },\n    ssh: {\n      enabled: false,\n      host: '0.0.0.0',\n      port: DEFAULT_PORT + 1,\n      title: `Node Monkey on ${os.hostname()}`,\n      prompt: `[Node Monkey] {@username}@${os.hostname()}:`\n    },\n\n    // Needed for storing things like user files and SSH host keys\n    dataDir: null\n  }, opts)\n\n  this.msgBuffer = []\n  this.BUNYAN_STREAM = bunyanStream(this)\n  this._attached = false\n  this._typeHandlers = {}\n\n  this._createLocal()\n  this._createRemote()\n  this._setupCmdMan()\n  this._setupUserManager()\n  this._setupServer()\n  this._setupSSH()\n\n  if (options.server.attachOnStart) {\n    this.attachConsole()\n  }\n\n  // TODO: Deprecated. Remove everything after this line by v1.0.0\n  let self = this\n  let warned = false\n  function warnConsole() {\n    if (!warned) {\n      warned = true\n      let warningMsg = [\n        `[Deprecation Warning] Running Node Monkey with 'augmentConsole' enabled.`,\n        `This is strongly discouraged and will be removed in the v1.0.0 release.`,\n        `See here for more info: https://github.com/jwarkentin/node-monkey/releases/tag/v1.0.0-rc.1`\n      ].join(' ')\n      self.local.warn(warningMsg)\n      self.remote.warn(warningMsg)\n    }\n  }\n\n  // This is here because webpack renames the function and for whatever reason the stack trace doesn't show the right name,\n  // even with proper source maps. This is all just temporary anyway so I'm hacking it.\n  Object.defineProperty(warnConsole, 'name', { value: 'warnConsole' })\n\n  console.local = _.mapValues(this.local, (fn, method) => {\n    let localFn = function() {\n      warnConsole()\n      return fn.apply(console, arguments)\n    }\n    Object.defineProperty(localFn, 'name', { value: method })\n    return localFn\n  })\n  console.remote = _.mapValues(this.remote, (fn, method) => {\n    let remoteFn = function() {\n      warnConsole()\n      return fn.apply({ callerStackDistance: 2 }, arguments)\n    }\n    Object.defineProperty(remoteFn, 'name', { value: method })\n    return remoteFn\n  })\n}\n\n_.assign(NodeMonkey.prototype, {\n  _getServerProtocol(server) {\n    if (server._events && server._events.tlsClientError) {\n      return 'https'\n    }\n    return 'http'\n  },\n\n  getServerPaths() {\n    let basePath = path.normalize(`${__dirname}/../dist`)\n\n    return {\n      basePath,\n      client: 'monkey.js',\n      index: 'index.html'\n    }\n  },\n\n  _displayServerWelcome() {\n    if (!this.options.server.silent) {\n      let server = this.options.server.server\n      if (server.listening) {\n        let proto = this._getServerProtocol(server)\n        let { address, port } = server.address()\n        this.local.log(`Node Monkey listening at ${proto}://${address}:${port}`)\n      } else {\n        server.on('listening', this._displayServerWelcome.bind(this))\n      }\n    }\n  },\n\n  _setupCmdMan() {\n    this._cmdMan = new CmdMan()\n    let cmdMan = this.cmdMan = this._cmdMan.bindI({\n      write: (val, opts) => {\n        console.log(val)\n      },\n      writeLn: (val, opts) => {\n        console.log(val)\n      },\n      error: (val, opts) => {\n        console.error(val)\n      },\n      prompt: (promptTxt, opts, cb) => {\n        if (typeof opts === 'function') {\n          cb = opts\n          opts = undefined\n        }\n        opts || (opts = {})\n\n        console.warn('Prompt not implemented')\n      }\n    })\n\n    this.addCmd = cmdMan.addCmd\n    this.runCmd = cmdMan.runCmd\n  },\n\n  _setupUserManager() {\n    let dataDir = this.options.dataDir\n    let userMan = this.userManager = new UserManager({\n      userFile: dataDir ? `${dataDir}/users.json` : undefined,\n      silent: this.options.server.silent\n    })\n\n    this.cmdMan.addCmd('showusers', (opts, term, done) => {\n      let users = userMan.getUsers().then(users => {\n        term.writeLn(Object.keys(users).join('\\n'))\n        done()\n      })\n    })\n\n    this.cmdMan.addCmd('adduser', (opts, term, done) => {\n      let args = opts.args,\n          username = args._[0]\n\n      if (!username) {\n        term.error(`You must specify a username`)\n        return done()\n      }\n\n      term.prompt('Password: ', { hideInput: true }, (error, password) => {\n        term.writeLn()\n        term.prompt('Again: ', { hideInput: true }, (error, passwordAgain) => {\n          term.writeLn()\n          if (password === passwordAgain) {\n            userMan.createUser(username, password)\n              .then(() => term.write(`Created user '${username}'`))\n              .catch(term.error)\n              .then(done)\n          } else {\n            term.error('Passwords do not match')\n            done()\n          }\n        })\n      })\n    })\n\n    this.cmdMan.addCmd('deluser', (opts, term, done) => {\n      let args = opts.args,\n          username = args._[0]\n\n      if (!username) {\n        term.error(`You must specify a username`)\n        return done()\n      }\n\n      userMan.deleteUser(username)\n        .then(() => term.write(`Deleted user '${username}'`))\n        .catch(term.error)\n        .then(done)\n    })\n\n    this.cmdMan.addCmd('passwd', (opts, term, done) => {\n      let args = opts.args,\n          user = opts.username\n\n      term.prompt('Current password: ', { hideInput: true }, (error, curpwd) => {\n        term.writeLn()\n        userMan.verifyUser(user, curpwd).then(matches => {\n          if (matches) {\n            term.prompt('Password: ', { hideInput: true }, (error, password) => {\n              term.writeLn()\n              term.prompt('Again: ', { hideInput: true }, (error, passwordAgain) => {\n                term.writeLn()\n                if (password === passwordAgain) {\n                  userMan.setPassword(user, password)\n                    .then(() => term.write(`Updated password for ${user}`))\n                    .catch(term.error)\n                    .then(done)\n                } else {\n                  term.error('Passwords do not match')\n                  done()\n                }\n              })\n            })\n          } else {\n            term.error('Incorrect password')\n            done()\n          }\n        })\n      })\n    })\n  },\n\n  _setupServer() {\n    let options = this.options,\n        server = options.server.server\n\n    if (!server) {\n      let serverApp = setupServer({\n        name: 'Node Monkey'\n      })\n      server = this.options.server.server = serverApp.server\n\n      let { host, port } = options.server\n      serverApp.listen(port, host)\n    }\n\n    this._displayServerWelcome()\n    this.serverApp = server\n    this.remoteClients = setupSocket({\n      server: server.server || server,\n      userManager: this.userManager,\n      onAuth: this._sendMessages.bind(this),\n      clientSettings: options.client\n    })\n  },\n\n  _setupSSH() {\n    let sshOpts = this.options.ssh\n    if (sshOpts.enabled) {\n      let dataDir = this.options.dataDir\n      if (!dataDir) {\n        throw new Error(`Options 'dataDir' is required to enable SSH`)\n      }\n\n      // Get host keys\n      let files = fs.readdirSync(dataDir),\n          keyRe = /\\.key$/,\n          hostKeys = []\n      for (let file of files) {\n        if (keyRe.test(file)) {\n          hostKeys.push(`${dataDir}/${file}`)\n        }\n      }\n\n      if (!hostKeys.length) {\n        console.log('No SSH host key found. Generating new host key...')\n        let keys = keypair()\n        fs.writeFileSync(`${dataDir}/rsa.key`, keys.private)\n        fs.writeFileSync(`${dataDir}/rsa.key.pub`, keys.public)\n        hostKeys = [ `${dataDir}/rsa.key` ]\n      }\n\n      this.SSHMan = new SSHMan({\n        monkey: this,\n        cmdManager: this._cmdMan,\n        userManager: this.userManager,\n        silent: this.options.server.silent,\n        host: sshOpts.host,\n        port: sshOpts.port,\n        title: _.result(sshOpts, 'title'),\n        prompt: _.result(sshOpts, 'prompt'),\n        hostKeys\n      })\n    }\n  },\n\n  // TODO: This whole process of trying to identify the true source of the call is so fucking messy and fragile. Need to think\n  //       of a better way to identify the call source and rewrite all this shitty code handling it right now.\n  _getCallerInfo(callerStackDistance) {\n    if (this.options.client.showCallerInfo) {\n      let stack = utils.getStack().map(frame => {\n        return {\n          functionName: frame.getFunctionName(),\n          methodName: frame.getMethodName(),\n          fileName: frame.getFileName(),\n          lineNumber: frame.getLineNumber(),\n          columnNumber: frame.getColumnNumber()\n        }\n      })\n\n      let caller = stack.find((frame, index, stack) => {\n        // We're either looking for a console method call or a bunyan log call. This logic will break down if method names change.\n        let twoBack = stack[index - 2]\n        let sixBack = stack[index - 4]\n        if (twoBack && twoBack.functionName === 'Logger._emit' && /\\/bunyan\\.js$/.test(twoBack.fileName)) {\n          return true\n        } else if (twoBack && sixBack && twoBack.methodName === 'emit' && sixBack.methodName === '_sendMessage') {\n          return true\n        }\n      })\n\n      if (!caller && typeof callerStackDistance === 'number') {\n        caller = stack[callerStackDistance]\n      }\n\n      if (caller) {\n        return {\n          caller: caller.functionName || caller.methodName,\n          file: caller.fileName,\n          line: caller.lineNumber,\n          column: caller.columnNumber\n        }\n      }\n    }\n  },\n\n  _sendMessage(info, callerStackDistance) {\n    this.msgBuffer.push({\n      method: info.method,\n      args: info.args,\n      callerInfo: info.callerInfo || this._getCallerInfo(callerStackDistance + 1)\n    })\n    if (this.msgBuffer.length > this.options.server.bufferSize) {\n      this.msgBuffer.shift()\n    }\n    this._sendMessages()\n  },\n\n  _sendMessages() {\n    let remoteClients = this.remoteClients\n    if (_.size(remoteClients.adapter.rooms['authed'])) {\n      _.each(this.msgBuffer, info => {\n        remoteClients.to('authed').emit('console', cycle.decycle(info))\n      })\n\n      this.msgBuffer = []\n    }\n  },\n\n  _createLocal() {\n    // NOTE: The console functions here should not be wrapped since these values are used to restore the defaults\n    //       when `detachConsole()` is called.\n    this.local = CONSOLE\n  },\n\n  _createRemote() {\n    let self = this\n    let remote = this.remote = {}\n    HANDLE_TYPES.forEach(method => {\n      self.remote[method] = function() {\n        self._sendMessage({\n          method,\n          args: Array.prototype.slice.call(arguments)\n        }, this.callerStackDistance ? this.callerStackDistance + 1 : 2)\n      }\n      Object.defineProperty(remote[method], 'name', { value: method })\n    })\n  },\n\n  attachConsole(disableLocalOutput) {\n    if (this._attached) {\n      return\n    }\n\n    if (!attachedCount) {\n      // If this function is in the process of handling the log call we will try and prevent potential infinite recursion\n      let handlersActive = 0\n      HANDLE_TYPES.forEach(method => {\n        console[method] = function() {\n          if (handlersActive) {\n            return self.local[method].apply(console, arguments)\n          }\n\n          ++handlersActive\n          ConsoleEvent.emit(method, ...arguments)\n          --handlersActive\n        }\n        Object.defineProperty(console[method], 'name', { value: method })\n      })\n    }\n\n    ++attachedCount\n\n    let self = this\n    let serverOptions = this.options.server\n    disableLocalOutput = disableLocalOutput !== undefined ? disableLocalOutput : serverOptions.disableLocalOutput\n\n    _.each(this.remote, (fn, method) => {\n      let handler = this._typeHandlers[method] = function() {\n        fn.apply({ callerStackDistance: 5 }, arguments)\n\n        if (!disableLocalOutput) {\n          self.local[method].apply(console, arguments)\n        }\n      }\n      Object.defineProperty(handler, 'name', { value: method })\n\n      ConsoleEvent.on(method, handler)\n    })\n\n    this._attached = true\n  },\n\n  detachConsole() {\n    Object.assign(console, this.local)\n    this._attached = false\n    --attachedCount\n\n    HANDLE_TYPES.forEach(method => {\n      ConsoleEvent.removeListener(method, this._typeHandlers[method])\n      delete this._typeHandlers[method]\n    })\n  }\n})\n\n\nlet instances = {}\nlet lastPort = DEFAULT_PORT - 1\nmodule.exports = function createInst(options, name = 'default') {\n  if (typeof options === 'string') {\n    name = options\n    options = undefined\n  }\n\n  if (!instances[name]) {\n    options || (options = {})\n    let port = _.get(options, 'server.port')\n    if (port) {\n      lastPort = +port\n    } else {\n      _.set(options, 'server.port', ++lastPort)\n      _.set(options, 'ssh.port', ++lastPort)\n    }\n    instances[name] = new NodeMonkey(options)\n  }\n\n  return instances[name]\n}\n\n// Just exporting in case someone needs to wrap this or access the internals for some reason\nmodule.exports.NodeMonkey = NodeMonkey\n\n\n/** WEBPACK FOOTER **\n ** ./server/app.js\n **/","module.exports = require(\"babel-runtime/core-js/object/assign\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/assign\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/get-iterator\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"os\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"os\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"child_process\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"child_process\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"lodash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lodash\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = require(\"keypair\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"keypair\"\n ** module id = 8\n ** module chunks = 0\n **/","/*\n    cycle.js\n    2016-05-01\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n*/\n\n/*jslint eval, for */\n\n/*property\n    $ref, decycle, forEach, isArray, keys, length, push, retrocycle, stringify,\n    test\n*/\n\nlet origJSON = global.JSON,\n    JSON = {}\nmodule.exports = JSON\n\nif (typeof JSON.decycle !== \"function\") {\n    JSON.decycle = function decycle(object, replacer) {\n        \"use strict\";\n\n// Make a deep copy of an object or array, assuring that there is at most\n// one instance of each object or array in the resulting structure. The\n// duplicate references (which might be forming cycles) are replaced with\n// an object of the form\n\n//      {\"$ref\": PATH}\n\n// where the PATH is a JSONPath string that locates the first occurance.\n\n// So,\n\n//      var a = [];\n//      a[0] = a;\n//      return JSON.stringify(JSON.decycle(a));\n\n// produces the string '[{\"$ref\":\"$\"}]'.\n\n// If a replacer function is provided, then it will be called for each value.\n// A replacer function receives a value and returns a replacement value.\n\n// JSONPath is used to locate the unique object. $ indicates the top level of\n// the object or array. [NUMBER] or [STRING] indicates a child element or\n// property.\n\n        var objects = [];   // Keep a reference to each unique object or array\n        var paths = [];     // Keep the path to each unique object or array\n\n        return (function derez(value, path) {\n\n// The derez function recurses through the object, producing the deep copy.\n\n            var i;          // The loop counter\n            var nu;         // The new object or array\n\n// If a replacer function was provided, then call it to get a replacement value.\n\n            if (replacer !== undefined) {\n                value = replacer(value);\n            }\n\n// typeof null === \"object\", so go on if this value is really an object but not\n// one of the weird builtin objects.\n\n            if (\n                typeof value === \"object\" && value !== null &&\n                !(value instanceof Boolean) &&\n                !(value instanceof Date) &&\n                !(value instanceof Number) &&\n                !(value instanceof RegExp) &&\n                !(value instanceof String)\n            ) {\n\n// If the value is an object or array, look to see if we have already\n// encountered it. If so, return a {\"$ref\":PATH} object. This is a hard\n// linear search that will get slower as the number of unique objects grows.\n// Someday, this should be replaced with an ES6 WeakMap.\n\n                i = objects.indexOf(value);\n                if (i >= 0) {\n                    return {$ref: paths[i]};\n                }\n\n// Otherwise, accumulate the unique value and its path.\n\n                objects.push(value);\n                paths.push(path);\n\n// If it is an array, replicate the array.\n\n                if (Array.isArray(value)) {\n                    nu = [];\n                    value.forEach(function (element, i) {\n                        nu[i] = derez(element, path + \"[\" + i + \"]\");\n                    });\n                } else {\n\n// If it is an object, replicate the object.\n\n                    nu = {};\n                    Object.keys(value).forEach(function (name) {\n                        nu[name] = derez(\n                            value[name],\n                            path + \"[\" + JSON.stringify(name) + \"]\"\n                        );\n                    });\n                }\n                return nu;\n            }\n            return value;\n        }(object, \"$\"));\n    };\n}\n\n\nif (typeof JSON.retrocycle !== \"function\") {\n    JSON.retrocycle = function retrocycle($) {\n        \"use strict\";\n\n// Restore an object that was reduced by decycle. Members whose values are\n// objects of the form\n//      {$ref: PATH}\n// are replaced with references to the value found by the PATH. This will\n// restore cycles. The object will be mutated.\n\n// The eval function is used to locate the values described by a PATH. The\n// root object is kept in a $ variable. A regular expression is used to\n// assure that the PATH is extremely well formed. The regexp contains nested\n// * quantifiers. That has been known to have extremely bad performance\n// problems on some browsers for very long strings. A PATH is expected to be\n// reasonably short. A PATH is allowed to belong to a very restricted subset of\n// Goessner's JSONPath.\n\n// So,\n//      var s = '[{\"$ref\":\"$\"}]';\n//      return JSON.retrocycle(JSON.parse(s));\n// produces an array containing a single element which is the array itself.\n\n        var px = /^\\$(?:\\[(?:\\d+|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\n\n        (function rez(value) {\n\n// The rez function walks recursively through the object looking for $ref\n// properties. When it finds one that has a value that is a path, then it\n// replaces the $ref object with a reference to the value that is found by\n// the path.\n\n            if (value && typeof value === \"object\") {\n                if (Array.isArray(value)) {\n                    value.forEach(function (element, i) {\n                        if (typeof element === \"object\" && element !== null) {\n                            var path = element.$ref;\n                            if (typeof path === \"string\" && px.test(path)) {\n                                value[i] = eval(path);\n                            } else {\n                                rez(element);\n                            }\n                        }\n                    });\n                } else {\n                    Object.keys(value).forEach(function (name) {\n                        var item = value[name];\n                        if (typeof item === \"object\" && item !== null) {\n                            var path = item.$ref;\n                            if (typeof path === \"string\" && px.test(path)) {\n                                value[name] = eval(path);\n                            } else {\n                                rez(item);\n                            }\n                        }\n                    });\n                }\n            }\n        }($));\n        return $;\n    };\n}\n\nJSON = origJSON\n\n\n/** WEBPACK FOOTER **\n ** ./lib/cycle.js\n **/","module.exports = require(\"babel-runtime/core-js/object/keys\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/keys\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/typeof\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/typeof\"\n ** module id = 11\n ** module chunks = 0\n **/","import utils from './utils'\n\nconst BUNYAN_TRACE = 10\nconst BUNYAN_DEBUG = 20\nconst BUNYAN_INFO = 30\nconst BUNYAN_WARN = 40\nconst BUNYAN_ERROR = 50\nconst BUNYAN_FATAL = 60\n\nlet levelFromName = {\n      'trace': BUNYAN_TRACE,\n      'debug': BUNYAN_DEBUG,\n      'info': BUNYAN_INFO,\n      'warn': BUNYAN_WARN,\n      'error': BUNYAN_ERROR,\n      'fatal': BUNYAN_FATAL\n    },\n    nameFromLevel = utils.invert(levelFromName)\n\nexport default inst => {\n  return {\n    write: function(rec) {\n      // TODO: Look for the first call that didn't originate in bunyan.js\n      rec = JSON.parse(rec)\n      let src = rec.src\n      inst._sendMessage({\n        method: nameFromLevel[rec.level] || 'info',\n        args: [ rec.msg, rec ],\n        callerInfo: src && {\n          caller: src.func || 'anonymous',\n          file: src.file,\n          line: src.line,\n          column: 0\n        }\n      })\n    }\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./server/bunyan-stream.js\n **/","import commonUtils from '../lib/common-utils'\nimport sourceMapSupport from 'source-map-support'\n\nexport default Object.assign({\n  parseCommand(str) {\n    const reg = /\"(.*?)\"|'(.*?)'|`(.*?)`|([^\\s\"]+)/gi\n    let arr = [],\n        match\n\n    do {\n      match = reg.exec(str)\n      if (match !== null) {\n        arr.push(match[1] || match[2] || match[3] || match[4])\n      }\n    } while (match !== null)\n\n    return arr\n  },\n\n  getStack() {\n    let prep = Error.prepareStackTrace\n    let limit = Error.stackTraceLimit\n    Error.prepareStackTrace = (error, trace) => trace.map(sourceMapSupport.wrapCallSite)\n    Error.stackTraceLimit = 30\n\n    let stack = new Error().stack\n    Error.prepareStackTrace = prep\n    Error.stackTraceLimit = limit\n\n    return stack.slice(1)\n  }\n}, commonUtils)\n\n\n/** WEBPACK FOOTER **\n ** ./server/utils.js\n **/","module.exports = {\n  isObject(value) {\n    let type = typeof value\n    return !!value && (type == 'object' || type == 'function')\n  },\n\n  invert(obj) {\n    let inverted = {}\n    for (let k in obj) {\n      if (obj.hasOwnProperty(k)) {\n        inverted[obj[k]] = k\n      }\n    }\n\n    return inverted\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./lib/common-utils.js\n **/","import restify from 'restify'\n\nexport default options => {\n  let server = restify.createServer()\n\n  server.pre(restify.pre.userAgentConnection())\n  server.use(restify.gzipResponse())\n  server.use(restify.CORS({\n    credentials: true\n  }))\n\n  server.get(/.*/, restify.serveStatic({\n    directory: __dirname,\n    default: 'index.html'\n  }))\n\n  return server\n}\n\n\n/** WEBPACK FOOTER **\n ** ./server/setup-server.js\n **/","module.exports = require(\"restify\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"restify\"\n ** module id = 16\n ** module chunks = 0\n **/","import _ from 'lodash'\nimport socketio from 'socket.io'\nimport CmdMan from './command-manager'\n\nexport default options => {\n  let io, ns\n  let userManager = options.userManager\n\n  if (typeof options.server === 'function') {\n    io = socketio(options.server)\n  } else {\n    io = socketio()\n    io.attach(options.server)\n  }\n\n  ns = io.of('/nm')\n  ns.on('connection', socket => {\n    let cmdMan = null\n    socket.emit('settings', options.clientSettings)\n    socket.emit('auth')\n\n    socket.on('auth', creds => {\n      userManager.verifyUser(creds.username, creds.password).then(result => {\n        socket.emit('authResponse', result, result ? undefined : 'Incorrect password')\n        if (result) {\n          socket.username = creds.username\n          socket.join('authed')\n          if (options.onAuth) {\n            options.onAuth(socket)\n          }\n        }\n      }).catch(err => {\n        socket.emit('authResponse', false, err)\n      })\n    })\n\n    socket.on('cmd', (cmdId, command) => {\n      if (!socket.username) {\n        socket.emit('cmdResponse', cmdId, `You are not authorized to run commands`)\n        return\n      }\n\n      if (!cmdMan) {\n        cmdMan = createCmdMan(socket)\n      }\n\n      cmdMan.runCmd(command, socket.username)\n        .then(output => {\n          socket.emit('cmdResponse', cmdId, null, output)\n        }).catch(err => {\n          socket.emit('cmdResponse', cmdId, err && err.message || err, null)\n        })\n    })\n  })\n\n  _.each(options.handlers, function(handler, event) {\n    io.on(event, handler)\n  })\n\n  return ns\n}\n\nfunction createCmdMan(socket) {\n  let promptId = 0,\n      prompts = {}\n\n  let cmdManOpts = {\n    writeLn: null,\n    write: (val, opts) => {\n      if (!val) return\n\n      socket.emit('console', {\n        method: 'log',\n        args: [ val ]\n      })\n    },\n    error: (val, opts) => {\n      if (!val) return\n\n      socket.emit('console', {\n        method: 'error',\n        args: [ val ]\n      })\n    },\n    prompt: (promptTxt, opts, cb) => {\n      if (typeof opts === 'function') {\n        cb = opts\n        opts = undefined\n      }\n      opts || (opts = {})\n\n      let pid = promptId++\n      socket.emit('prompt', pid, promptTxt, opts)\n\n      prompts[pid] = cb\n    }\n  }\n  cmdManOpts.writeLn = cmdManOpts.write\n\n  socket.on('promptResponse', (promptId, response) => {\n    if (prompts[promptId]) {\n      prompts[promptId](null, response)\n    }\n  })\n\n  return new CmdMan(cmdManOpts)\n}\n\n\n/** WEBPACK FOOTER **\n ** ./server/setup-socket.js\n **/","module.exports = require(\"socket.io\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"socket.io\"\n ** module id = 18\n ** module chunks = 0\n **/","import _ from 'lodash'\nimport utils from './utils'\nimport minimist from 'minimist'\n\nfunction CommandManager() {\n  this.commands = {}\n}\n\nObject.assign(CommandManager.prototype, {\n  addCmd(cmdName, opts, exec) {\n    if (this.commands[cmdName]) {\n      throw new Error(`'${cmdName}' is already registered as a command`)\n    }\n\n    if (typeof opts === 'function') {\n      exec = opts\n      opts = {}\n    }\n\n    this.commands[cmdName] = {\n      opts,\n      exec\n    }\n  },\n\n  bindI(ioInterface) {\n    let boundI = _.mapValues(this)\n    Object.assign(boundI, _.mapValues(this.constructor.prototype, (val, key) => {\n      if (val instanceof Function) {\n        if (key === 'runCmd') {\n          return val.bind(this, ioInterface)\n        }\n        return val.bind(this)\n      } else {\n        return val\n      }\n    }))\n\n    return boundI\n  },\n\n  runCmd(io, rawCommand, asUser) {\n    return new Promise((resolve, reject) => {\n      let parsed = utils.parseCommand(rawCommand),\n          cmdName = parsed[0],\n          cmd = this.commands[cmdName]\n\n      if (!asUser) {\n        return reject(`Missing user context for command '${cmdName}'`)\n      }\n\n      if (!cmd) {\n        return reject(`Command not found: '${cmdName}'`)\n      }\n\n      let args = minimist(parsed.slice(1))\n      cmd.exec({\n          args,\n          username: asUser\n        }, {\n          write: io.write,\n          writeLn: io.writeLn,\n          error: io.error,\n          prompt: io.prompt\n        },\n        resolve\n      )\n    })\n  }\n})\n\n\nexport default CommandManager\n\n\n/** WEBPACK FOOTER **\n ** ./server/command-manager.js\n **/","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/promise\"\n ** module id = 20\n ** module chunks = 0\n **/","module.exports = require(\"minimist\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"minimist\"\n ** module id = 21\n ** module chunks = 0\n **/","import fs from 'fs'\nimport ssh2 from 'ssh2'\nimport termkit from 'terminal-kit'\nimport CmdMan from './command-manager'\n\nfunction SSHManager(options) {\n  this.options = options = Object.assign({\n    host: '127.0.0.1',\n    port: 50501,\n    title: 'Node Monkey',\n    prompt: 'Node Monkey:',\n    silent: false\n  }, options)\n\n  this.clients = {}\n  this.clientId = 1\n\n  this.server = ssh2.Server({\n    hostKeys: options.hostKeys.map(file => {\n      return fs.readFileSync(file)\n    })\n  }, this.onClient.bind(this))\n\n  let monkey = this.options.monkey\n  this.server.listen(options.port, options.host, function() {\n    options.silent || monkey.local.log(`SSH listening on ${this.address().port}`)\n  })\n}\n\nObject.assign(SSHManager.prototype, {\n  shutdown() {\n    let clients = this.clients\n    for (let c of clients) {\n      c.write('\\nShutting down')\n      c.close()\n    }\n  },\n\n  onClient(client) {\n    let clientId = clientId++\n    this.clients[clientId] = new SSHClient({\n      client,\n      cmdManager: this.options.cmdManager,\n      userManager: this.options.userManager,\n      title: this.options.title,\n      prompt: this.options.prompt,\n      onClose: () => delete this.clients[clientId]\n    })\n  }\n})\n\n\nfunction SSHClient(options) {\n  this.options = options\n  this.client = options.client\n  this.cmdMan = null\n  this.userManager = options.userManager\n  this.session = null\n  this.stream = null\n  this.term = null\n  this.ptyInfo = null\n\n  this.title = options.title\n  this.promptTxt = `${options.prompt} `\n  this.inputActive = false\n  this.cmdHistory = []\n\n  this.username = null\n\n  this.client.on('authentication', this.onAuth.bind(this))\n  this.client.on('ready', this.onReady.bind(this))\n  this.client.on('end', this.onClose.bind(this))\n}\n\nObject.assign(SSHClient.prototype, {\n  _initCmdMan() {\n    let cmdManOpts = {\n      writeLn: null,\n      write: (val, opts) => {\n        opts || (opts = {})\n        val || (val = '')\n\n        if (opts.bold) {\n          this.term.bold(val)\n        } else {\n          this.term(val)\n        }\n\n        if (opts.newline) {\n          this.term.nextLine()\n        }\n      },\n      error: (val, opts) => {\n        opts || (opts = {})\n\n        // TODO: Apparently by sending this to stdout there is a timing issue and anything send to\n        //       stdout appears before this value is send to stderr for some reason.\n        // this.term.red.error(val)\n        this.term.red(val)\n\n        if (opts.newline) {\n          this.term.nextLine()\n        }\n      },\n      prompt: (promptTxt = '', opts, cb) => {\n        if (typeof opts === 'function') {\n          cb = opts\n          opts = undefined\n        }\n        opts || (opts = {})\n\n        let inputOpts = {}\n        if (opts.hideInput) {\n          inputOpts.echo = false\n        }\n\n        this.term(promptTxt)\n        this.term.inputField(inputOpts, cb)\n      }\n    }\n    cmdManOpts.writeLn = (val, opts) => {\n      opts || (opts = {})\n      opts.newline = true\n      cmdManOpts.write(val, opts)\n    }\n    this.cmdMan = this.options.cmdManager.bindI(cmdManOpts)\n  },\n\n  write(msg, opts) {\n    opts || (opts = {})\n    if (this.term) {\n      if (opts.style) {\n        this.term[style](msg)\n      } else {\n        this.term(msg)\n      }\n    }\n  },\n\n  close() {\n    if (this.stream) {\n      this.stream.end()\n    }\n    this.onClose()\n  },\n\n  onAuth(ctx) {\n    if (ctx.method == 'password') {\n      this.userManager.verifyUser(ctx.username, ctx.password).then(result => {\n        if (result) {\n          this.username = ctx.username\n          ctx.accept()\n        } else {\n          ctx.reject()\n        }\n      }).catch(err => {\n        ctx.reject()\n      })\n    } else if (ctx.method == 'publickey') {\n      ctx.reject()\n    } else {\n      ctx.reject()\n    }\n  },\n\n  onReady() {\n    this.client.on('session', (accept, reject) => {\n      this.session = accept()\n\n      this.session\n        .once('pty', (accept, reject, info) => {\n          this.ptyInfo = info\n          accept && accept()\n        })\n        .on('window-change', this.onWindowChange.bind(this))\n        .once('shell', (accept, reject) => {\n          this.stream = accept()\n          this._initCmdMan()\n          this._initStream()\n          this._initTerm()\n        })\n    })\n  },\n\n  onWindowChange(accept, reject, info) {\n    let stream = this.stream\n    Object.assign(this.ptyInfo, info)\n    if (stream) {\n      stream.rows = info.rows\n      stream.columns = info.cols\n      stream.emit('resize')\n    }\n    accept && accept()\n  },\n\n  onClose() {\n    let onClose = this.options.onClose\n    onClose && onClose()\n  },\n\n  onKey(name, matches, data) {\n    if (name === 'CTRL_L') {\n      this.clearScreen()\n    } else if (name === 'CTRL_D') {\n      this.term.nextLine()\n      this.close()\n    }\n  },\n\n  _initStream() {\n    let stream = this.stream\n    stream.name = this.title\n    stream.rows = this.ptyInfo.rows || 24\n    stream.columns = this.ptyInfo.cols || 80\n    stream.isTTY = true\n    stream.setRawMode = () => {}\n    stream.on('error', error => {\n      console.error('SSH stream error:', error.message)\n    })\n    stream.stdout.getWindowSize = () => {\n      return [ this.ptyInfo.cols, this.ptyInfo.rows ]\n    }\n  },\n\n  _initTerm() {\n    let stream = this.stream\n\n    let term = this.term = termkit.createTerminal({\n      stdin: stream.stdin,\n      stdout: stream.stdout,\n      stderr: stream.stderr,\n      generic: this.ptyInfo.term,\n      appName: this.title\n    })\n    term.options.crlf = true\n\n    term.on('key', this.onKey.bind(this))\n    term.windowTitle(this._interpolate(this.title))\n    this.clearScreen()\n  },\n\n  _interpolate(str) {\n    let varRe = /{@(.+?)}/g\n    let vars = {\n      username: this.username\n    }\n\n    let match\n    while(match = varRe.exec(str)) {\n      if (vars[match[1]]) {\n        str = str.replace(match[0], vars[match[1]])\n      }\n    }\n\n    return str\n  },\n\n  clearScreen() {\n    this.term.clear()\n    this.prompt()\n  },\n\n  prompt() {\n    let term = this.term\n    term.windowTitle(this._interpolate(this.title))\n    term.bold(this._interpolate(this.promptTxt))\n\n    if (!this.inputActive) {\n      this.inputActive = true\n      term.inputField({\n        history: this.cmdHistory,\n        autoComplete: Object.keys(this.cmdMan.commands),\n        autoCompleteMenu: true\n      }, (error, input) => {\n        this.inputActive = false\n        input[0] !== ' ' && this.cmdHistory.push(input)\n        term.nextLine()\n\n        if (input === 'exit') {\n          this.close()\n        } else if (input === 'clear') {\n          this.clearScreen()\n        } else if (input) {\n          this.cmdMan.runCmd(input, this.username)\n            .then(output => {\n              if (typeof output !== 'string') {\n                output = JSON.stringify(output, null, '  ')\n              }\n              this.term(output)\n              this.term.nextLine()\n              this.prompt()\n            })\n            .catch(err => {\n              if (typeof err !== 'string') {\n                err = err.message || JSON.stringify(err, null, '  ')\n              }\n              this.term.red.error(err)\n              this.term.nextLine()\n              this.prompt()\n            })\n        } else {\n          this.prompt()\n        }\n      })\n    }\n  }\n})\n\n\nexport default SSHManager\n\n\n/** WEBPACK FOOTER **\n ** ./server/ssh-manager.js\n **/","module.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/json/stringify\"\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = require(\"ssh2\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"ssh2\"\n ** module id = 24\n ** module chunks = 0\n **/","module.exports = require(\"terminal-kit\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"terminal-kit\"\n ** module id = 25\n ** module chunks = 0\n **/","import fs from 'fs'\nimport scrypt from 'scrypt'\n\nlet useNew = false\ntry {\n  Buffer.from('', 'base64')\n} catch(err) {\n  useNew = true\n}\n\nfunction stringToBuffer(string, base) {\n  if (useNew) {\n    return new Buffer(string, base)\n  } else {\n    return Buffer.from(string, base)\n  }\n}\n\nfunction UserManager(options) {\n  this.userFile = options.userFile\n  this.userFileCache = null\n  this.userFileCreated = false\n\n  if (!options.silent) {\n    this.getUsers().then(users => {\n      let usernames = Object.keys(users)\n      if (!usernames.length) {\n        if (process.env.NODE_ENV === 'production') {\n          console.warn(`No users have been created and you are running in production mode so you will not be able to login.\\n`)\n        } else {\n          console.warn(`It seems there are no users and you are not running in production mode so you will not be able to login. This is probably a bug. Please report it!\\n`)\n        }\n      } else if (usernames.length === 1 && usernames[0] === 'guest') {\n        console.warn(`[WARN] No users detected. You can login with default user 'guest' and password 'guest' when prompted.\\n` +\n          `This user will be disabled when you create a user account.\\n`)\n      }\n    })\n  }\n}\n\nObject.assign(UserManager.prototype, {\n  _readFile() {\n    if (this.userFileCache) {\n      return this.userFileCache\n    }\n\n    try {\n      if (!this.userFile) {\n        let err = new Error(`No user file specified`)\n        err.code = 'ENOENT'\n        throw err\n      }\n\n      this.userFileCache = JSON.parse(fs.readFileSync(this.userFile))\n      this.userFileCreated = true\n      setTimeout(() => { this.userFileCache = null }, 5000)\n\n      return this.userFileCache\n    } catch(err) {\n      if (err.code === 'ENOENT') {\n        return process.env.NODE_ENV === 'production'\n          ? {}\n          : {\n            guest: {\n              password: 'c2NyeXB0AAEAAAABAAAAAZS+vE1+zh4nY6vN21zM3dIzpJVImr8OrK0iJoA+iUPk7WIdo3RhgeATzWENocd7gKNbEKVgq6LbXqrmVjLtnYy5FXyfRCtEtmjUuj19AqcW'\n            }\n          }\n      }\n      throw err\n    }\n  },\n\n  _writeFile(data) {\n    this.userFileCache = null\n    fs.writeFileSync(this.userFile, JSON.stringify(data, null, '  '))\n    this.userFileCreated = true\n  },\n\n  _hashPassword(passwd) {\n    return scrypt.kdfSync(passwd.normalize('NFKC'), { N: 1, r: 1, p: 1 }).toString('base64')\n  },\n\n  _verifyPassword(hash, passwd) {\n    return scrypt.verifyKdfSync(stringToBuffer(hash, 'base64'), passwd.normalize('NFKC'))\n  },\n\n  createUser(username, password) {\n    return new Promise((resolve, reject) => {\n      if (!this.userFile) {\n        return reject(new Error(`No user file found. Did you forget to set the 'dataDir' option?`))\n      }\n\n      let users = this._readFile()\n      if (users[username]) {\n        return reject(new Error(`User '${username}' already exists`))\n      }\n\n      if (!this.userFileCreated) {\n        delete users['guest']\n      }\n\n      users[username] = {\n        password: this._hashPassword(password)\n      }\n      this._writeFile(users)\n      resolve()\n    })\n  },\n\n  deleteUser(username) {\n    return new Promise((resolve, reject) => {\n      if (!this.userFile) {\n        return reject(new Error(`No user file found. Did you forget to set the 'dataDir' option?`))\n      }\n\n      let users = this._readFile()\n      if (!users[username]) {\n        return reject(new Error(`User '${username}' does not exist`))\n      }\n\n      if (!this.userFileCreated) {\n        return reject(new Error(`User file has not been created`))\n      }\n\n      delete users[username]\n      this._writeFile(users)\n      resolve()\n    })\n  },\n\n  setPassword(username, password) {\n    return new Promise((resolve, reject) => {\n      if (!this.userFile) {\n        return reject(new Error(`No user file found. Did you forget to set the 'dataDir' option?`))\n      }\n\n      let users = this._readFile()\n\n      users[username].password = this._hashPassword(password)\n      this._writeFile(users)\n      resolve()\n    })\n  },\n\n  getUsers() {\n    return new Promise((resolve, reject) => {\n      resolve(this._readFile())\n    })\n  },\n\n  getUserData(username) {\n    return new Promise((resolve, reject) => {\n      let users = this._readFile()\n      if (!users[username]) {\n        return reject(new Error(`User '${username}' does not exist`))\n      }\n\n      resolve(users[username])\n    })\n  },\n\n  verifyUser(username, passwd) {\n    return new Promise((resolve, reject) => {\n      this.getUserData(username).then(userData => {\n        resolve(this._verifyPassword(userData.password, passwd))\n      }).catch(reject)\n    })\n  }\n})\n\n\nexport default UserManager\n\n\n\n/** WEBPACK FOOTER **\n ** ./server/user-manager.js\n **/","module.exports = require(\"scrypt\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"scrypt\"\n ** module id = 27\n ** module chunks = 0\n **/","module.exports = require(\"events\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"events\"\n ** module id = 29\n ** module chunks = 0\n **/","module.exports = require(\"source-map-support\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"source-map-support\"\n ** module id = 30\n ** module chunks = 0\n **/"],"sourceRoot":""}